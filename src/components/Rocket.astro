<div class="rocket" id="rocket">
    <div class="rocket-body">
        <div class="rocket-window"></div>
        <div class="rocket-fin">
            <div class="rocket-fin__inner"></div>
        </div>
        <div class="rocket-fin">
            <div class="rocket-fin__inner"></div>
        </div>
        <div class="rocket-fin"></div>
    </div>
    <div class="flames" id="flames">
        <div class="flame-wrapper"><div class="flame-inner"></div></div>
        <div class="flame-wrapper"><div class="flame-outer"></div></div>
    </div>
</div>

<style>
    .rocket {
        position: fixed;
        top: -0.5rem;
        left: 1.5rem;
        transform: scale(0.4) translate(-50%, -50%) rotate(45deg);
        pointer-events: none;
        user-select: none;
        z-index: 999;

        /* Scroll-driven animations using view-timeline */
        animation-timeline: scroll(root);
        animation-range: auto;
        animation-name: rocketMove;
        animation-fill-mode: both;
        animation-timing-function: ease-in-out;
    }

    .rocket.rotate {
        transform: translate(-50%, -50%) rotate(0deg);
        animation-name: rocketMoveReverse;
    }

    @keyframes rocketMove {
        0% {
            top: -0.5rem;
            left: 1.5rem;
            scale: 0.4;
            transform: translate(-50%, -50%) rotate(45deg);
        }
        10% {
            top: -25vh;
            left: 25%;
            scale: 2;
            transform: translate(-50%, -50%) rotate(180deg);
        }
        30% {
            top: 50vh;
            left: 75%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(180deg);
            z-index: 99;
        }
        50% {
            top: 50vh;
            left: 25%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(180deg);
            z-index: 99;
        }
        80% {
            top: 50vh;
            left: 75%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(180deg);
            z-index: 99;
        }
        100% {
            top: 105vh;
            left: 50%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(180deg);
            z-index: 99;
        }
    }

    @keyframes rocketMoveReverse {
        0% {
            top: -0.5rem;
            left: 1.5rem;
            scale: 0.4;
            transform: translate(-50%, -50%) rotate(45deg);
        }
        10% {
            top: -25vh;
            left: 25%;
            scale: 2;
            transform: translate(-50%, -50%) rotate(0deg);
        }
        30% {
            top: 50vh;
            left: 75%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(0deg);
            z-index: 99;
        }
        50% {
            top: 50vh;
            left: 25%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(0deg);
            z-index: 99;
        }
        80% {
            top: 50vh;
            left: 75%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(0deg);
            z-index: 99;
        }
        100% {
            top: 105vh;
            left: 50%;
            scale: 1;
            transform: translate(-50%, -50%) rotate(0deg);
            z-index: 99;
        }
    }

    .rocket-body {
        width: 40px;
        height: 100px;
        background: var(--nord4-snow-storm);
        border-radius: 50% 50% 0 0;
        position: relative;
        margin: 0 auto;
        box-shadow: var(--shadow-4);
        z-index: 200;
    }

    .rocket-window {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 20px;
        height: 20px;
        background: var(--nord9-frost);
        border-radius: 50%;
        box-shadow: var(--shadow-2);
    }

    .rocket-fin {
        position: absolute;
        bottom: -10px;
    }

    .rocket-fin__inner {
        position: relative;
        width: 20px;
        height: 40px;
        background: var(--nord11-aurora);
    }

    .rocket-fin:nth-child(2),
    .rocket-fin:nth-child(3) {
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2))
            drop-shadow(0 4px 5px rgba(0, 0, 0, 0.14))
            drop-shadow(0 1px 10px rgba(0, 0, 0, 0.12));
        z-index: 100;
    }

    .rocket-fin:nth-child(2) {
        left: -20px;
    }

    .rocket-fin:nth-child(3) {
        right: -20px;
    }

    .rocket-fin:nth-child(2) div {
        clip-path: polygon(100% 0, 0% 100%, 100% 100%);
    }

    .rocket-fin:nth-child(3) div {
        clip-path: polygon(100% 100%, 0% 100%, 0% 0%);
    }

    .rocket-fin:nth-child(4) {
        width: 5px;
        height: 50px;
        background: var(--nord11-aurora);
        right: 17.5px;
        bottom: -20px;
        box-shadow: var(--shadow-4);
        z-index: 100;
    }

    .flames {
        position: relative;
        width: 40px;
        height: 40px;
        clip-path: polygon(0 0, 100% 0, 50% 100%);
        opacity: 0;
    }

    .flames.on {
        animation: flame 0.3s steps(3) infinite alternate;
        opacity: 1;
    }

    .flame-wrapper {
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2))
            drop-shadow(0 4px 5px rgba(0, 0, 0, 0.14))
            drop-shadow(0 1px 10px rgba(0, 0, 0, 0.12));
    }

    .flame-wrapper:has(.flame-inner) {
        position: absolute;
        top: 0;
        left: 7.5px;
        z-index: 2;
    }

    .flame-inner {
        position: relative;
        width: 25px;
        height: 25px;
        clip-path: polygon(0 0, 100% 0, 50% 100%);
        background: var(--nord13-aurora);
    }

    .flame-wrapper:has(.flame-outer) {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
    }

    .flame-outer {
        position: relative;
        width: 40px;
        height: 40px;
        clip-path: polygon(0 0, 100% 0, 50% 100%);
        background: var(--nord11-aurora);
    }

    @keyframes flame {
        0% {
            transform: translateY(0);
        }
        100% {
            transform: translateY(-20px);
        }
    }
</style>

<script type="module" is:inline>
    document.addEventListener("DOMContentLoaded", () => {
        const rocket = document.getElementById("rocket");
        const flames = document.getElementById("flames");

        if (!rocket && !flames) return;

        let lastScrollY = window.scrollY;

        window.addEventListener("scroll", () => {
            const currentScrollY = window.scrollY;

            if (currentScrollY < lastScrollY) {
                rocket.classList.add("rotate");
            } else {
                rocket.classList.remove("rotate");
            }

            if (currentScrollY > 0) {
                flames.classList.add("on");
            } else {
                flames.classList.remove("on");
            }

            lastScrollY = currentScrollY;
        });
    });
</script>
